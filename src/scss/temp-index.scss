// TODO: Move to utility class section in static-assets

[layout="horizontal"] {
    display: flex;
    flex-direction: column;
}
[layout="horizontal"] {
    display: flex;
    flex-direction: row;
}
[flex="fill"] {
    flex: 1;
}
[flex="auto"] {
    flex: 0;
}

// FormHome content
// TODO: Move FormHome styles into this repo
.FormHome--centered .FormHome-main-content {
    flex: 0 0 auto;
}

// Layout shorthand

.l-fullWidth {
    width: 100%;
}
.l-pageMaxWidth {
    max-width: $screen-md-lg;
}


wnd-section-control-nav-buttons {
    display: flex;
}

wnd-submission-version-editor, wnd-form-version-view {
    max-width: 100%;
}

// --- Grid Control --- //

grid-field-nform > wnd-field-block > .FieldBlock > .FieldBlock-content {
    /* width: 100%; */
    max-width: none;
    > .FieldBlock-fields > wnd-field > .Field {
        max-width: none;
    }
}
grid-field-nform .Table--gridControl {
    .Table-body-cell:not(.Table-row-actions):not(.Table-body-cell--add) {
        padding: 0 !important;
        margin: 0 !important;
    }
    font-size: $FieldInput-fontSize;
    width: auto;
    margin-left: 0;
}
.Table--gridControl {
    .Table-body-row {
        height: auto;
    }
    .FieldBlock-helpTip {
        display: none !important;
    }
    .Field, .FieldBlock {
        margin-bottom: 0 !important;
    }
    .Field {
        min-width: 0;
    }
    .FieldBlock {
        padding-top: .5em;
        padding-bottom: .5em;
        padding-left: 1em;
        padding-right: 1em;
    }
    .Table-header-cell:first-child, .Table-body-cell:first-child {
        .FieldBlock {
            padding-left: 0;
        }
    } 
    .Table-header-cell:last-child, .Table-body-cell:last-child {
        .FieldBlock {
            padding-right: 0;
        }
    }
    .Table-body-cell {
        vertical-align: top;
    }
    .Table-body-cell.Table-row-actions {
        vertical-align: middle;
    }
    // Candidate for reuse
    .Table-body-cell--add {
        background: #ececec;
        text-align: center;
    }
    .Stepper-input {
        width: 4em;
    }
    .bs .uib-time.hours input, .bs .uib-time.minutes input {
        width: 4em;
    }
    .Field-label {
        display: none;
    }
    .FieldBlock-content {
        margin-bottom: 0;
    }
    .FieldBlock-fields > table {
        border-spacing: 0;
        border-collapse: collapse;
        table-layout: auto;
    }

    .FieldBlock {
        margin: 0 !important;
    }
    .FieldBlock-validation {
        position: absolute;
        top: 100%;
        right: 0;
        z-index: 20;

        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .FieldBlock-validation-message {
        margin: 0;
        margin-top: 1px;
    }
    // TODO: show helpTips on column headers
    .FieldBlock .FieldBlock-helpTip {
        display: none !important;
    }

    .FieldBlock-validation-message--error:first-child:after {
        display: block;
        @include verticalValidationMessageDisplay();
    }

    // Display errors only as icon until the cell is hovered, then allow message to be expanded below
    .FieldBlock:not(:hover) > .FieldBlock-validation {
        bottom: 0;
        right: 0;
        top: auto;
        left: auto;
        
        width: auto; // Canceling out 100%-width used to center messages on hover
        .FieldBlock-validation-message-text {
            display: none !important;
        }
        // Only display first icon
        .FieldBlock-validation-message:not(:first-child) .FieldBlock-validation-image {
            display: none !important;
        }
        .FieldBlock-validation-image {
            margin: 0;
            height: 14px;
            width: 14px;
        }
        .FieldBlock-validation-message {
            border-radius: 999px;
            min-height: 0;
            padding: 0;
            margin: 0;
            padding: 3px;
            bottom: 2px;
            right: 2px;
        }
        .FieldBlock-validation-message:first-child:after {
            display: none;
        }
    }
}

grid-field-nform .Table--gridControl {
    /* margin-left: 16px; */
    border-bottom: 1px solid gainsboro;
}

grid-field-nform .Table--gridControl .Table-header-cell:first-child {
    // padding-left: 11px !important;
    padding-left: 8px;
}

grid-field-nform tbody.Table-body, 
grid-field-nform tfoot {
    border-left: 1px solid gainsboro;
    border-right: 1px solid gainsboro;
}

.Table--gridControl .Table-body-cell.Table-row-actions:last-child {
    padding-right: 12px;
    padding-left: 12px;
}

.Table--gridControl .Table-body-cell {
    border-bottom: 0;
}

.Table--gridControl .FieldBlock {
    margin: 0 !important;
    padding: 2px 7px 6px;
}
.Table--gridControl .Table-body-cell:first-child .FieldBlock {
    padding-top: 4px;
    padding-left: 8px;
}
.Table--gridControl .Table-body-row:last-child .FieldBlock {
    padding-bottom: 8px;
}

.Table-body-row:nth-child(2n) {
    background-color: hsl(0, 0%, 98%);
}

.Table-body-row:nth-child(2n - 1) {
    background-color: hsl(0, 0%, 93%);
}

.Table--gridControl .Table-body-cell--is-readOnly {
    vertical-align: middle;
    .FieldBlock {
        &, &:first-child, &:last-child {
            padding-top: 0;
            padding-bottom: 0;
        }
    }
}

.Table--gridControl tfoot .FieldBlock {
    padding: 8px 4px;
}

grid-field-nform .Table--gridControl .Table-header-cell {
    padding-left: 7px;
    padding-top: 8px;
    padding-bottom: 4px;
}

grid-field-nform tfoot {
    background-color: #ddd;
    border-top: 1px solid gainsboro;
}

grid-field-nform {
    md-input-container .md-input,
    .md-select-value {
        border-color: hsla(0, 0%, 0%, .15) !important;
    }
    md-input-container.md-input-focused .md-input:not([disabled]),
    md-select:not([disabled]):focus .md-select-value {
        border-color: $Material-input-borderColor--active !important;
    }
}


//// ---- END disgusting grid control styles ----




instructions-field-nform .Field {
    max-width: none;
}

.AppForm-instructions {
    max-width: 42em;
    // white-space: pre-line;
    .AppForm-text {
        background: #efefef;
        padding: 0px 20px 1em;
    }
}
.AppForm-instructions--preLine {
    white-space: normal;
    max-width: none;
    padding-bottom: 1em;
    .AppForm-text {
        white-space: pre-line;
        max-width: 42em;
    }
}
.AppForm-instructions--separator {
    border-top: 1px solid;
    background: none;
    margin: 0;
    padding: 0;
    margin-bottom: 2em;
    .AppForm-text {
        background: none;
        padding: 0;
    }
}
.AppForm-instructions--readOnly {
    background: none;
    padding: 0;
    margin-bottom: 1em;
    .AppForm-text {
        background: none;
        padding: 0;
    }
}

@function sqrt($r) {
  $x0: 1;
  $x1: $x0;
 
  @for $i from 1 through 10 {
    $x1: $x0 - ($x0 * $x0 - abs($r)) / (2 * $x0);
    $x0: $x1;
  }
 
  @return $x1;
}

$FeeTag-border-width: 2px;
$FeeTag-border-color: #e6e6e6;
$FeeTag-border-radius: 5px;
$FeeTag-height: $font-size-base * 3; //3rem
$FeeTag-height-diagonal: (sqrt(2) * $FeeTag-height / 2);
$FeeTag-hole-width: $FeeTag-height / 6;

.AppForm-feeTag {
    position: relative;
    height: $FeeTag-height;
}

.AppForm-feeTag-content, .AppForm-feeTag:before {
    background: #efefef;
    border-radius: $FeeTag-border-radius;
    border: $FeeTag-border-width solid $FeeTag-border-color;
    background: #efefef;
}
.AppForm-feeTag:before {
    content: '';
    position: absolute;
    width: calc(#{$FeeTag-height-diagonal} - #{$FeeTag-border-width});
    height: calc(#{$FeeTag-height-diagonal} - #{$FeeTag-border-width});
    top: 50%;
    // left: calc(#{$FeeTag-height-diagonal} - #{$FeeTag-border-width});
    left: 0;
    // transform: translateY(-50%) translateX(calc(-50% - #{$FeeTag-border-width})) rotate(-45deg);
    transform: translateY(-50%) translateX(#{$FeeTag-height-diagonal / 4 + $FeeTag-border-width}) rotate(-45deg);
}

.AppForm-feeTag-content {
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: .33rem 1rem;
    padding-left: calc(1rem + #{$FeeTag-hole-width});
    position: relative;
    height: 100%;
    margin-left: $FeeTag-height / 2;
    border-left: 0;
    border-top-left-radius: ($FeeTag-border-width / 2) + $FeeTag-border-radius;
    border-bottom-left-radius: ($FeeTag-border-width / 2) + $FeeTag-border-radius;
}

.AppForm-feeTag-description, .AppForm-feeTag-amount {
    line-height: 1em;
}

.AppForm-feeTag-description {
    color: #6d6d6d;
    font-size: .85em;
    padding-bottom: .15em;
}

.AppForm-feeTag-content:after {
    content: '';
    position: absolute;
    width: $FeeTag-hole-width;
    height: $FeeTag-hole-width;
    background: white;
    transform: translate(0, -50%);
    border-radius: 999px;
    left: 0;
    top: 50%;
    border: $FeeTag-border-width solid $FeeTag-border-color;
}

.AppForm-sectionViewport--isRemoved {
    .PageHeader-heading, .CardRepeater-item-name, .CardRepeater-item-count {
        text-decoration: line-through;
        color: $app-color-validation-error-text;
    }
}
.AppForm-sectionViewport--isRemoved, .control--isRemoved {
    .Field-input, .Field-label, .FieldBlock-label, .FieldBlockGroup-label {
        text-decoration: line-through;
        color: $app-color-validation-error-text;
    }
}

// Geocoding address validator
.menudemoBasicUsage .md-menu-demo {
  padding: 24px; 
}
.menudemoBasicUsage .menu-demo-container {
  min-height: 200px; 
}
.address-item {
  height: auto;
  flex: 0 0 auto;
}
.address-button {
  padding: 1em 2em;
}
.address-line {
  line-height: 1em;  
}


// Login/Reset Password (Auth)

.AuthInterface-element {
    margin: 0 2rem;
}
.AuthInterface-header {
    margin-top: 1.5rem;
}
.AuthInterface-body {
    margin: 1.5rem 0;
}



// ------------------------------------------------------------------
// -------------- Integral-header header switching classes ----------
// ---- (this lets us swap out headers at different breakpoints) ----
// ------------------------------------------------------------------

// Includes some business regarding "integral" headers and iframe headers..
// "integral header" is really just to distinguish from iframe-based headers, which will hopefully be gone before long

$form-entry-mobile-breakpoint: $screen-sm;

@media screen and (max-width: $form-entry-mobile-breakpoint) {
    body[integral-headers*="mobile"] {
        .IntegralHeader-breakpoint--mobile {
            display: block !important;
        }
        .IFrameHeader {
            display: none !important;
        }
    }
}

@media screen and (min-width: $form-entry-mobile-breakpoint + 1px) {
    body[integral-headers*="default"] {
        .IntegralHeader-breakpoint--default {
            display: block !important;
        }
        .IFrameHeader {
            display: none !important;
        }
    }
}


// -----------------------------------------
// ---- Mobile Submission Wizard Styles ----
// -----------------------------------------


// Required for smooth iOS sectional scrolling
.AppForm-sectionScroll {
    -webkit-overflow-scrolling: touch;
}


@media screen and (min-width: $form-entry-mobile-breakpoint + 1px) {
    .u-AppForm-showMobile, .u-AppForm-hideMobile--headerCollapsed {
        display: none !important;
    }
}
@media screen and (max-width: $form-entry-mobile-breakpoint) {
    // TODO: test this with client custom headers
    #header-logo {
       width: auto;
    }

    .u-AppForm-hideMobile {
        display: none !important;
    }

    .AppForm-sidePanelContainer {
        display: none !important;
    }

    .AppForm-section-content {
        padding-left: 2.25rem;
        padding-right: 2.25rem;
    }

}

.AppForm-header--mobile {
    display: block;
    background-color: rgb(54, 54, 58);
    color: white;
    &:not(.AppForm-header--is-expanded) .u-AppForm-hideMobile--headerCollapsed {
        display: none !important;
    }
    &.AppForm-header--is-expanded .AppForm-heading, .AppForm-header-separator {
        border-bottom: 1px solid gray;
    }
    .AppForm-title {
        white-space: normal;
    }
    .AppForm-revision {
        color: #b1b5b7;
    }
    .TitleGroup {
        flex: 1;
    }
    .TitleGroup-sub {
        display: block;
    }
    .AppForm-header-item:not(:only-child) {
        margin-bottom: 1rem;
    }
}

.AppForm-header--is-expanded {
    .IconButton--expandHeader svg {
        transform: scaleY(-1);
    }
}
.IconButton--expandHeader polyline {
    stroke-width: 2px;
}

.IconButton {
    height: 2em;
    width: 2em;
    padding: .33em;
}

.IconButton--small {
    font-size: 14px;
}
.IconButton--smallPadding {
    padding: .33em;
}

.IconButtonRow {
    display: flex;
    align-items: center;
}

.IconButtonRow--innerPadChildren {
    > *:not(:last-child) {
        margin-right: .33em;
    }
    &.IconButtonRow--innerPadRightmost {
        > :last-child {
            margin-right: .33em;
        }
    }
}

.AppForm-actionsContainer--mobile {
    display: inline-flex;
    flex-direction: column;
    align-items: stretch;
}
.AppForm-actionsContainer--mobile .AppForm-actionsContainer-item {
    margin-bottom: .5rem;
    > * {
        width: 100%;
    }
}

.SectionControlSwitchLayout {
    display: flex;
    align-items: flex-start;
}
.SectionControlSwitchLayout-main {
    flex: 1;
}
.SectionControlSwitchLayout-aside {
    flex: 0 0 auto;
    display: flex;
    align-self: stretch;
    align-items: flex-start;
}

.SectionControlSwitchLayout--is-highlighted {
    // position: relative;
    // z-index: 100;
    // display: block;
    margin: -20px -20px 0 -20px;
    padding: 20px 20px 0 20px;
    border-radius: 5px;
    background-color: hsla(hue($color-brightblue), 100%, 55%, 0.1);
    border: 1px dashed $color-brightblue;
    .FieldBlock.FieldBlock--is-error {
        background-color: transparent;
    }
}
.SectionControlSwitchLayout--is-highlighted-correctionRequest {
    background-color: hsla(hue($app-color-correctionRequest-base), 100%, 55%, 0.1);
    border-color: $app-color-correctionRequest-base;
}